fname = 'worldmap.json';
fid = fopen(fname);
raw = fread(fid, inf);
std = char(raw');
fclose(fid);
map_json = jsondecode(std);

num_features = length(map_json.features);

figure(1);
clf
hold on;
axis equal;

for ind_feature = 1:num_features
    geometry = map_json.features(ind_feature).geometry;

    disp(geometry.type);
    if strcmp(geometry.type, 'Polygon')
        disp(geometry);
        polygon = squeeze(geometry.coordinates);
        if isnumeric(polygon)
            plot(polygon(:, 1), polygon(:, 2), 'k');
        end
    end
    if strcmp(geometry.type, 'MultiPolygon')
        num_cell = length(geometry.coordinates);

        for ind_cell = 1:num_cell
            polygon = squeeze(geometry.coordinates{ind_cell});
            if isnumeric(polygon)
                plot(polygon(:, 1), polygon(:, 2), 'k');
            end
        end
    end
end

path = [...
24.69, 50.04; ...
22.31, 55.09; ...
21.03, 57.70; ...
20.04, 59.66; ...
19.21, 61.29; ...
18.48, 62.70; ...
17.82, 63.95; ...
17.22, 65.08; ...
16.66, 66.12; ...
16.14, 67.09; ...
15.65, 67.99; ...
15.19, 68.84; ...
14.75, 69.64; ...
14.33, 70.40; ...
13.93, 71.13; ...
13.55, 71.83; ...
13.18, 72.49; ...
12.83, 73.13; ...
12.49, 73.75; ...
12.15, 74.35; ...
11.83, 74.93; ...
11.52, 75.49; ...
11.22, 76.03; ...
10.93, 76.56; ...
10.65, 77.07; ...
10.37, 77.57; ...
10.11, 78.06; ...
9.84, 78.53; ...
9.59, 79.00; ...
9.34, 79.46; ...
9.10, 79.90; ...
8.86, 80.34; ...
8.63, 80.77; ...
8.41, 81.19; ...
8.19, 81.60; ...
7.97, 82.00; ...
7.76, 82.40; ...
7.56, 82.79; ...
7.36, 83.18; ...
7.16, 83.56; ...
6.97, 83.93; ...
6.78, 84.30; ...
6.60, 84.66; ...
6.42, 85.02; ...
6.24, 85.38; ...
6.07, 85.73; ...
5.90, 86.07; ...
5.73, 86.41; ...
5.57, 86.75; ...
5.41, 87.08; ...
5.26, 87.41; ...
5.11, 87.74; ...
4.96, 88.06; ...
4.81, 88.38; ...
4.67, 88.70; ...
4.53, 89.01; ...
4.39, 89.32; ...
4.25, 89.63; ...
4.12, 89.93; ...
3.99, 90.24; ...
3.87, 90.54; ...
3.74, 90.84; ...
3.62, 91.13; ...
3.51, 91.43; ...
3.39, 91.72; ...
3.28, 92.01; ...
3.17, 92.30; ...
3.06, 92.59; ...
2.95, 92.87; ...
2.85, 93.15; ...
2.75, 93.44; ...
2.65, 93.72; ...
2.55, 94.00; ...
2.46, 94.27; ...
2.37, 94.55; ...
2.28, 94.82; ...
2.19, 95.10; ...
2.11, 95.37; ...
2.02, 95.64; ...
1.94, 95.91; ...
1.86, 96.18; ...
1.79, 96.45; ...
1.71, 96.72; ...
1.64, 96.99; ...
1.57, 97.26; ...
1.50, 97.52; ...
1.44, 97.79; ...
1.38, 98.05; ...
1.31, 98.32; ...
1.25, 98.58; ...
1.20, 98.84; ...
1.14, 99.11; ...
1.09, 99.37; ...
1.04, 99.63; ...
0.99, 99.89; ...
0.94, 100.16; ...
0.90, 100.42; ...
0.85, 100.68; ...
0.81, 100.94; ...
0.77, 101.20; ...
0.74, 101.47; ...
0.70, 101.73; ...
0.67, 101.99; ...
0.64, 102.25; ...
0.61, 102.51; ...
0.58, 102.77; ...
0.56, 103.04; ...
0.53, 103.30; ...
0.51, 103.56; ...
0.50, 103.83; ...
0.48, 104.09; ...
0.46, 104.35; ...
0.45, 104.62; ...
0.44, 104.89; ...
0.43, 105.15; ...
0.42, 105.42; ...
0.42, 105.69; ...
0.42, 105.95; ...
0.42, 106.22; ...
0.42, 106.49; ...
0.42, 106.76; ...
0.43, 107.03; ...
0.44, 107.31; ...
0.45, 107.58; ...
0.46, 107.85; ...
0.47, 108.13; ...
0.49, 108.41; ...
0.51, 108.69; ...
0.53, 108.96; ...
0.55, 109.25; ...
0.58, 109.53; ...
0.61, 109.81; ...
0.64, 110.10; ...
0.67, 110.38; ...
0.71, 110.67; ...
0.74, 110.96; ...
0.78, 111.25; ...
0.82, 111.55; ...
0.87, 111.84; ...
0.91, 112.14; ...
0.96, 112.44; ...
1.02, 112.74; ...
1.07, 113.04; ...
1.13, 113.35; ...
1.19, 113.66; ...
1.25, 113.97; ...
1.31, 114.28; ...
1.38, 114.60; ...
1.45, 114.92; ...
1.53, 115.24; ...
1.60, 115.57; ...
1.68, 115.90; ...
1.76, 116.23; ...
1.85, 116.56; ...
1.94, 116.90; ...
2.03, 117.24; ...
2.12, 117.59; ...
2.22, 117.94; ...
2.32, 118.29; ...
2.43, 118.65; ...
2.54, 119.01; ...
2.65, 119.38; ...
2.76, 119.75; ...
2.88, 120.13; ...
3.01, 120.51; ...
3.13, 120.90; ...
3.27, 121.30; ...
3.40, 121.70; ...
3.54, 122.10; ...
3.69, 122.52; ...
3.84, 122.94; ...
3.99, 123.36; ...
4.15, 123.80; ...
4.32, 124.24; ...
4.49, 124.69; ...
4.66, 125.16; ...
4.85, 125.63; ...
5.04, 126.11; ...
5.23, 126.60; ...
5.43, 127.11; ...
5.64, 127.62; ...
5.86, 128.15; ...
6.09, 128.70; ...
6.32, 129.26; ...
6.56, 129.83; ...
6.82, 130.43; ...
7.08, 131.04; ...
7.35, 131.68; ...
7.64, 132.33; ...
7.94, 133.02; ...
8.26, 133.73; ...
8.59, 134.48; ...
8.94, 135.26; ...
9.31, 136.08; ...
9.70, 136.95; ...
10.12, 137.87; ...
10.58, 138.85; ...
11.06, 139.92; ...
11.60, 141.08; ...
12.19, 142.36; ...
12.85, 143.81; ...
13.63, 145.49; ...
14.57, 147.56; ...
15.88, 150.42];

curve1 = [...
61.12210233525891, 19.659130293124047; ...
62.185231532407464, 22.288661051511156; ...
62.78044745223474, 23.925702186384736; ...
63.22217164146944, 25.232021483054336; ...
63.57991300282702, 26.354468368422726; ...
63.88307316656524, 27.355343701797228; ...
64.14736974848496, 28.268038236179382; ...
64.38237272113687, 29.112927568496126; ...
64.59442104752436, 29.903533060314086; ...
64.78797096719182, 30.649374208490304; ...
64.96629674172299, 31.357452332473375; ...
65.13188920856523, 32.03309742507334; ...
65.28669601552437, 32.680477586653495; ...
65.43227495275774, 33.30292553278964; ...
65.5698960325989, 33.90315596045184; ...
65.70061137853338, 34.483414724664556; ...
65.8253048897535, 35.04558489307856; ...
65.94472829850484, 35.591263828316; ...
66.05952769168906, 36.12182009238906; ...
66.17026384152568, 36.638436939972635; ...
66.27742760848123, 37.14214567438082; ...
66.38145178091081, 37.633850339654195; ...
66.48272108223058, 38.11435032753173; ...
66.58157935956886, 38.584355239328765; ...
66.67833594179987, 39.044498692156026; ...
66.77327052414861, 39.49534897552184; ...
66.86663733672482, 39.93741804064419; ...
66.95866861040936, 40.371168971691844; ...
67.04957732085019, 40.79702203715519; ...
67.13955963251995, 41.2153599699532; ...
67.2287969944689, 41.626532471757166; ...
67.31745777737505, 42.03086006534423; ...
67.40569867420714, 42.42863644685145; ...
67.49366618417551, 42.82013272190448; ...
67.58149753711074, 43.20559880950914; ...
67.66932174270801, 43.58526585637192; ...
67.75726029882598, 43.95934792872893; ...
67.84542805684882, 44.32804378217759; ...
67.9339337250135, 44.69153812563003; ...
68.02288047588898, 45.05000292835317; ...
68.11236649827079, 45.403598590560414; ...
68.20248528864518, 45.75247477324711; ...
68.2933261971406, 46.09677144765727; ...
68.38497467979954, 46.436619747471724; ...
68.47751242179406, 46.772141834983664; ...
68.57101802372385, 47.1034529479623; ...
68.66556686091073, 47.43066092031243; ...
68.76123150764211, 47.75386707483216; ...
68.8580817881263, 48.07316655380244; ...
68.95618499907613, 48.388648796298774; ...
69.05560612171132, 48.70039797949702; ...
69.15640780167459, 49.00849322852956; ...
69.25865063168922, 49.31300908811689; ...
69.36239309750013, 49.61401567389484; ...
69.46769181043878, 49.9115792044566; ...
69.57460134494093, 50.20576148763211; ...
69.6831745905705, 50.49662122612523; ...
69.79346268336302, 50.78421355763756; ...
69.90551496822827, 51.06859031931891; ...
70.01937909973424, 51.349800279251; ...
70.13510113437876, 51.62788934942482; ...
70.25272537890035, 51.902900603006685; ...
70.37229459101589, 52.17487456160795; ...
70.49384981139782, 52.443849193635806; ...
70.61743042387559, 52.70986008575332; ...
70.74307429508748, 52.972940777663155; ...
70.8708172546381, 53.2331220454387; ...
71.00069374917396, 53.49043318258869; ...
71.13273631178959, 53.74490126908612; ...
71.26697566510843, 53.99655147748691; ...
71.40344074024792, 54.24540719598811; ...
71.5421584818288, 54.49149000928221; ...
71.68315383954572, 54.73481980620116; ...
71.82644977562754, 54.97541489337462; ...
71.97206700551817, 55.213291942408155; ...
72.12002410430006, 55.448466167895354; ...
72.27033733306472, 55.68095142544618; ...
72.4230202031622, 55.910759686537084; ...
72.57808402968743, 56.13790205645959; ...
72.73553723639, 56.36238809504729; ...
72.89538551206866, 56.58422612384451; ...
73.05763148124662, 56.80342316099588; ...
73.22227462371315, 57.01998500144806; ...
73.38931118239645, 57.23391629035351; ...
73.558733786746, 57.445220451721276; ...
73.73053146891708, 57.65389982839648; ...
73.90468926554112, 57.85995561211395; ...
74.08118805607182, 58.06338790302966; ...
74.26000453310236, 58.26419591027798; ...
74.44111025436226, 58.46237733676317; ...
74.6244723012952, 58.65792931057879; ...
74.81005229747461, 58.85084776642076; ...
74.9978062817471, 59.04112763356348; ...
75.18768444243115, 59.228762883927565; ...
75.37963053041135, 59.41374644957159; ...
75.573581677298, 59.59607032727712; ...
75.76946774735829, 59.775725493350734; ...
75.9672109370553, 59.95270193773868; ...
76.16672534827214, 60.126988695894234; ...
76.36791634656822, 60.29857386936901; ...
76.57067963621415, 60.46744424466662; ...
76.77490119473163, 60.633585884845424; ...
76.98045608490132, 60.79698367524342; ...
77.18720788492554, 60.957621441517944; ...
77.39500758787852, 61.11548182918003; ...
77.60369288537157, 61.27054634326052; ...
77.8130868903691, 61.422795213054556; ...
78.02299704892084, 61.572207351254484; ...
78.23321393986674, 61.718760299759715; ...
78.44350963047637, 61.862430060906206; ...
78.65363632167072, 62.003191106316244; ...
78.86332406903105, 62.14101588011327; ...
79.07227940509418, 62.27587512807796; ...
79.2801827595032, 62.40773738895118; ...
79.48668583586154, 62.53656878386772; ...
79.6914088050762, 62.66233275447526; ...
79.89393715367522, 62.78498975699715; ...
80.0938176750591, 62.904496781738544; ...
80.29055449011442, 63.020806952102596; ...
80.48360387091878, 63.133868876937925; ...
80.67236865764842, 63.24362598435428; ...
80.85619189074436, 63.35001578200505; ...
81.03434839092495, 63.45296850296408; ...
81.2060367608485, 63.552406375138105; ...
81.37036802864394, 63.648241778646465; ...
81.52635329907788, 63.74037551207474; ...
81.67288882881641, 63.8286945497616; ...
81.80873778836344, 63.913069185612606; ...
81.93250873638769, 63.99334958589517; ...
82.04262882730829, 64.06936132044409; ...
82.13731127851997, 64.14089977859943; ...
82.21451500076451, 64.20772300485207; ...
82.27189361800642, 64.26954233823196; ...
82.30673147821693, 64.32601031347384; ...
82.31586083461636, 64.37670428437386; ...
82.29555473212147, 64.4211048951149; ...
82.24138505231161, 64.4585661515584; ...
82.14803121779417, 64.48827389791767; ...
82.00901780570997, 64.50918677381674; ...
81.81634455592149, 64.51994997734916; ...
81.55995083896981, 64.51876587387441; ...
81.2269131568793, 64.50319294814447; ...
80.80019186029911, 64.46982012969728; ...
80.2565717598673, 64.41371149225051; ...
79.56304820992676, 64.32739498092636; ...
78.66991505139754, 64.19885425701285; ...
77.49583221443517, 64.0070262917241; ...
75.88912319189188, 63.70968331844502; ...
73.48952860655592, 63.19844744086477; ...
68.50488252382728, 61.88166922750803; ...
151.62984025505443, 52.44147526358973; ...
155.18348592484665, 49.46451358755936; ...
157.5910445065028, 47.06203753234306; ...
159.48650003676863, 44.901452091437264; ...
161.06453471319463, 42.88858271106086; ...
162.41821861338707, 40.98188537606996; ...
163.60148719559564, 39.15912210495379; ...
164.64927660685012, 37.40694233309973; ...
165.58592278881983, 35.71667580732791; ...
166.4292663625719, 34.08234650524698; ...
167.19288893095273, 32.4996307517963; ...
167.88743242268282, 30.96526770042212; ...
168.5214274797572, 29.47670482424184; ...
169.10183965745847, 28.03187423717461; ...
169.6344416055897, 26.629052343131896; ...
170.12408068080038, 25.26675641769147; ...
170.57486987380776, 23.94368265973445; ...
170.99033201759997, 22.658658643510993; ...
171.37350910058473, 21.41061030349185; ...
171.72704643720857, 20.19853903095049; ...
172.0532592825495, 19.02150414024655; ...
172.3541853399821, 17.878611101919052; ...
172.6316273494238, 16.76900238737328; ...
172.8871877259155, 15.691850788889742; ...
173.12229689441492, 14.646354429510183; ...
173.33823640895162, 13.631735630180172; ...
173.5361593389639, 12.647234635548342; ...
173.7171061958228, 11.692110515430986; ...
173.88201912429426, 10.765639042029106; ...
174.03175361176463, 9.86711219786661; ...
174.16708882212944, 8.995837181872336; ...
174.28873617573373, 8.151136364616624; ...
174.39734695355037, 7.332346887841808; ...
174.493518892849, 6.538820370386114; ...
174.57780174469673, 5.769923127714815; ...
174.65070239515023, 5.025035764566106; ...
174.7126891401868, 4.30355295061889; ...
174.76419541432625, 3.6048851816065355; ...
174.80562347288995, 2.9284557187361195; ...
174.837347110526, 2.2737027322864165; ...
174.85971441746307, 1.6400786127029632; ...
174.87305017261386, 1.0270498104370558; ...
174.87765785452606, 0.43409696156073296; ...
174.87382162353666, -0.13928547961155793; ...
174.86180791403757, -0.6935891597302721; ...
174.84186697876117, -1.2292920679721984; ...
174.81423427692488, -1.746858787357962; ...
174.77913158290716, -2.246740803868158; ...
174.73676827419982, -2.729375594883099; ...
174.6873421007959, -3.1951886529776865; ...
174.63104020790124, -3.6445924431950982; ...
174.5680399455316, -4.07798702080817; ...
174.49850953979, -4.495760109914741; ...
174.42260882877164, -4.8982875135672606; ...
174.3404898060616, -5.285933206101245; ...
174.25229719874855, -5.659049647862714; ...
174.15816898308086, -6.017978071706338; ...
174.05823679173417, -6.36304861156156; ...
173.95262631174919, -6.6945809054680545; ...
173.8414578994137, -7.012883336880527; ...
173.72484652255721, -7.318254666735647; ...
173.602902370749, -7.610983415508788; ...
173.4757310398536, -7.89134824203909; ...
173.34343380993977, -8.159618215090388; ...
173.20610790155982, -8.416053082374972; ...
173.06384665940226, -8.660903404413524; ...
172.91673978993558, -8.894410866602087; ...
172.76487351277834, -9.116808410893263; ...
172.6083307409413, -9.328320474835605; ...
172.4471911341199, -9.529163348705096; ...
172.28153164753436, -9.719544770305507; ...
172.11142603623193, -9.899664986268936; ...
171.9369453772898, -10.069716326015557; ...
171.75815807668468, -10.229883533939391; ...
171.57512997054494, -10.380343950374439; ...
171.38792439300204, -10.521267618723375; ...
171.1966022695335, -10.652817478582257; ...
171.00122217151602, -10.775149464238767; ...
170.80184038284114, -10.888412650513835; ...
170.5985109555849, -10.992749381478003; ...
170.39128574837363, -11.088295355429922; ...
170.18021433063203, -11.175179807598772; ...
169.96534457880205, -11.2535253539147; ...
169.74672185722497, -11.323448432948261; ...
169.52438960192697, -11.38505914071488; ...
169.2983891947555, -11.438461344865296; ...
169.06875997381673, -11.483752741483249; ...
168.83553923456097, -11.521024892711228; ...
168.59876223111658, -11.550363254732849; ...
168.35846216257687, -11.571847190338227; ...
168.1146701642125, -11.585549975754411; ...
167.86741528524863, -11.591538789206073; ...
167.61672428723327, -11.589874673053945; ...
167.36262229616162, -11.580612519211513; ...
167.1051317397642, -11.56380098459408; ...
166.8442729817964, -11.53948243529217; ...
166.58006409483937, -11.507692848839861; ...
166.31252078710932, -11.468461684875882; ...
166.04165634709986, -11.421811782631424; ...
165.76748153862778, -11.367759163439871; ...
165.49000452526676, -11.306312879713238; ...
165.20923075784154, -11.23747479102524; ...
164.92516284285972, -11.161239295504707; ...
164.6378002366062, -11.077593033391647; ...
164.347139858119, -10.986514779440634; ...
164.05317475574472, -10.887974728079685; ...
163.7558947136796, -10.781934354338807; ...
163.45528581951476, -10.668345839550373; ...
163.15133025997793, -10.547151612109628; ...
162.84400604540934, -10.418283736700811; ...
162.53328670040122, -10.281663223827413; ...
162.21914096452696, -10.137199346621621; ...
161.90153238228697, -9.984788721921294; ...
161.58041891433885, -9.82431441738372; ...
161.25575222752204, -9.6556447193839; ...
160.92747801090138, -9.47863232057497; ...
160.59553409221752, -9.293112308578811; ...
160.25985055739304, -9.098900904314274; ...
159.92034877089395, -8.895793587379101; ...
159.57694043456002, -8.683562934183268; ...
159.22952649643418, -8.461956109041147; ...
158.87799596403121, -8.23069211983195; ...
158.5222244046287, -7.9894583727187305; ...
158.16207231009872, -7.737906893565496; ...
157.79738309039155, -7.475649707968578; ...
157.42798070238044, -7.202253382090286; ...
157.05366664226702, -6.917232475084711; ...
156.6742175780795, -6.620042547103071; ...
156.28937975766078, -6.310069616563191; ...
155.898865135213, -5.986619703342891; ...
155.5023449714265, -5.648904522543917; ...
155.09944236234705, -5.296024328476132; ...
154.68972275250403, -4.926946162411157; ...
154.27268188929722, -4.540476257071309; ...
153.84773043187843, -4.1352247997026295; ...
153.4141736601621, -3.709559538739925; ...
152.9711847094638, -3.261544633247964; ...
152.517767860257, -2.7888572544867385; ...
152.05270935194824, -2.2886739509874574; ...
151.57450408248042, -1.75750596699217; ...
151.08125189608745, -1.1909618117212988; ...
150.5704982970102, -0.5833856637047478; ...
150.03898215738218, 0.07271531468440559; ...
149.48221346385222, 0.7876283991558741; ...
148.89371623710994, 1.5761499806406338; ...
148.2635400017586, 2.4609530056090225; ...
147.57493182330992, 3.480106861714868; ...
146.79527654418348, 4.707523946266728; ...
145.84086867403633, 6.332359225147804; ...
144.03755806471773, 9.872159363857978];

curve2 = [...
59.18914535098476, 15.610710151794136; ...
57.791463028018555, 13.11756779337025; ...
56.863894220948396, 11.618386127978603; ...
56.09205076324248, 10.451421782876825; ...
55.40645770339067, 9.469850351513122; ...
54.77774786236715, 8.611396530542734; ...
54.19023862187062, 7.84269571845102; ...
53.63439558294878, 7.1433991080797155; ...
53.1039158754177, 6.500012710545674; ...
52.59437974600863, 5.9030451902126835; ...
52.10255059413093, 5.345523715975311; ...
51.625975185890915, 4.822147764016636; ...
51.16274431135099, 4.328779342542037; ...
50.71133916329816, 3.862116514598419; ...
50.27052936409977, 3.419476158658476; ...
49.83930299668728, 2.9986447208151614; ...
49.41681698347121, 2.597772222379355; ...
49.00236107756665, 2.215295243338563; ...
48.595331255725334, 1.8498799459150193; ...
48.195209497988394, 1.500378713384729; ...
47.801548113919516, 1.1657968443619515; ...
47.41395871313949, 0.8452674704012361; ...
47.03210108889867, 0.5380296953322434; ...
46.655676722511394, 0.24341322249529052; ...
46.28442233394612, -0.03917521041734775; ...
45.918104922367064, -0.3102625417195978; ...
45.55651763784787, -0.570318308171748; ...
45.19947636141019, -0.8197620426298129; ...
44.846816891415735, -1.0589693689300363; ...
44.498392538781424, -1.2882772121300272; ...
44.15407209044009, -1.507988213892702; ...
43.81373789932672, -1.7183745255887888; ...
43.47728528621273, -1.919680521310711; ...
43.14461994087496, -2.112126317991396; ...
42.81565773177326, -2.295909605966894; ...
42.49032352561802, -2.4712078562066764; ...
42.16855038800978, -2.638180061720956; ...
41.85027884088901, -2.7969683441574213; ...
41.53545625687369, -2.9476992731875997; ...
41.224036297682844, -3.090485082249224; ...
40.91597842143733, -3.2254247332242794; ...
40.611247472096686, -3.352604810113007; ...
40.30981327996009, -3.47210037541694; ...
40.011650144616674, -3.5839757338437255; ...
39.71673732570151, -3.6882847947649484; ...
39.42505757469836, -3.785072095151983; ...
39.136597713155794, -3.8743729786837258; ...
38.85134821002398, -3.956214137787416; ...
38.569303005869216, -4.030613992569555; ...
38.29045934250831, -4.097583047533333; ...
38.014817614704036, -4.1571241993904895; ...
37.74238124616361, -4.209233002576442; ...
37.47315656921111, -4.253897910133403; ...
37.20715272824054, -4.291100479333151; ...
36.94438141428429, -4.3208155700606605; ...
36.684857491822406, -4.343011419368702; ...
36.42859787548031, -4.357649901513878; ...
36.175622182968176, -4.36468653974704; ...
35.92595250893175, -4.364070633333229; ...
35.67961338798754, -4.355745324715096; ...
35.436631769177744, -4.3396476426785275; ...
35.197036987181086, -4.31570856762398; ...
34.9608607583907, -4.28385302410794; ...
34.728137165442355, -4.243999921372874; ...
34.49890266119864, -4.196062140387338; ...
34.27319593346226, -4.139946459217514; ...
34.05105850962942, -4.0755537219598335; ...
33.83253388691144, -4.002778527878484; ...
33.61766815433533, -3.921509370684214; ...
33.40650988222217, -3.8316285277799853; ...
33.199110175348885, -3.7330119655134; ...
32.99552270783222, -3.6255293054290716; ...
32.79580378865316, -3.509043717374032; ...
32.60001244124172, -3.383411789745144; ...
32.40821045346728, -3.2484834913145764; ...
32.220462492357626, -3.10410197696648; ...
32.03683604851616, -2.950103431250848; ...
31.8574020418397, -2.7863173254795077; ...
31.68223421026585, -2.612565625664114; ...
31.511409700179744, -2.4286631328344206; ...
31.34500911740911, -2.2344171327630296; ...
31.18311664268571, -2.0296273267543534; ...
31.025820212117125, -1.8140856252221258; ...
30.873211716596252, -1.5875759260958695; ...
30.72538715548965, -1.34987404392222; ...
30.582446901413466, -1.100747398195748; ...
30.4444958911448, -0.8399549316103305; ...
30.311643896296445, -0.5672468750290393; ...
30.184005744615813, -0.28236428643994815; ...
30.061701909391207, 0.014960248383288119; ...
29.944858388466393, 0.325004121235334; ...
29.833607358029102, 0.6480540212630437; ...
29.72808750348812, 0.9844063905179464; ...
29.62844448051638, 1.3343677075759108; ...
29.53483132569314, 1.698254547186639; ...
29.44740904734707, 2.076393972244245; ...
29.36634712948241, 2.469123587633734; ...
29.291824180117125, 2.876791811007509; ...
29.22402865041709, 3.299758161205033; ...
29.163159475260322, 3.738393576938041; ...
29.109427143299122, 4.1930796232067955; ...
29.063054290944354, 4.664210257577853; ...
29.02427690706896, 5.152190906211174; ...
28.993345443269664, 5.657439005712289; ...
28.97052595723617, 6.180383931012943; ...
28.95610157949243, 6.72146736105402; ...
28.950373941474716, 7.281143169778886; ...
28.95366489548459, 7.859877586808438; ...
28.966318440237114, 8.458149360677988; ...
28.988702725552788, 9.076449564687907; ...
29.02121247290997, 9.715282142210867; ...
29.064271549246484, 10.375162227766586; ...
29.118335945428623, 11.056618392030847; ...
29.183897142354695, 11.76019110564484; ...
29.261485770659085, 12.486432741655927; ...
29.351675893029533, 13.235907456683021; ...
29.4550898950084, 14.009191105305876; ...
29.57240381079584, 14.806870595701144; ...
29.70435375587686, 15.629543947710538; ...
29.85174294060289, 16.4778195824803; ...
30.015449963303578, 17.35231605511793; ...
30.19643851102268, 18.253662411920807; ...
30.395767701689728, 19.182494993814576; ...
30.61460580111291, 20.139461093847483; ...
30.854244530746097, 21.125215880066534; ...
31.11611682488776, 22.140422972021813; ...
31.401817640143584, 23.18575458941207; ...
31.713128404815794, 24.26189149045277; ...
32.0520466770436, 25.369524137611315; ...
32.42082136737543, 26.50935363488406; ...
32.82199578913326, 27.68209411152682; ...
33.258460334029216, 28.888476392794697; ...
33.733517090311956, 30.129252723127085; ...
34.25096146958775, 31.405205877046267; ...
34.81518270728485, 32.717156456974756; ...
35.43129678678288, 34.06598455807545; ...
36.10531509627799, 35.45265045108191; ...
36.84436890542016, 36.87822976731466; ...
37.65701270607957, 38.34396593671622; ...
38.55364241245897, 39.85134770700918; ...
39.5470905539564, 41.402229644950786; ...
40.65350192391165, 42.999023124925046; ...
41.89367623243364, 44.6450096486458; ...
43.29523940827001, 46.344882629031964; ...
44.89639818432343, 48.105743829990075; ...
46.753025110749626, 49.939086805952904; ...
48.953819217866794, 51.86528279751934; ...
51.6592921270053, 53.925663612877784; ...
55.24038582076721, 56.227469946651475; ...
61.50227960287769, 59.36092283906424; ...
142.31236389751982, 57.93456644208582; ...
139.59924190281905, 59.05239279142075; ...
137.98300296689754, 59.62331032366537; ...
136.83459162861132, 59.98090980644111; ...
135.9635244942628, 60.22018841778319; ...
135.28032631220628, 60.38336108598334; ...
134.73415506671688, 60.493199032143316; ...
134.2927496847584, 60.563460384570284; ...
133.9340977138657, 60.60310942930864; ...
133.6423854543503, 60.61831274080398; ...
133.40580687688282, 60.6134903381924; ...
133.21528134673352, 60.59191445972494; ...
133.0636563636626, 60.55607194682542; ...
132.94518769653908, 60.50789424467464; ...
132.85518745624822, 60.44890935234914; ...
132.78977699331614, 60.38034517619475; ...
132.7457099863301, 60.30320218372963; ...
132.7202418718293, 60.21830542778259; ...
132.71103193295232, 60.12634264422435; ...
132.71606849813637, 60.0278926541428; ...
132.73361095133862, 59.92344685529738; ...
132.76214411455697, 59.81342573615579; ...
132.80034196693472, 59.69819170579329; ...
132.84703847751047, 59.57805917358001; ...
132.90120388633656, 59.453302497562255; ...
132.96192516840662, 59.324162724630256; ...
133.02839013899185, 59.19085230574165; ...
133.09987395149565, 59.05355965531106; ...
133.17572794863568, 58.91245252998707; ...
133.25537012870538, 58.76768093246724; ...
133.33827718858046, 58.61937946448301; ...
133.4239775984335, 58.46766935532343; ...
133.51204574114004, 58.31266013050367; ...
133.60209688069736, 58.15445101073981; ...
133.69378268542854, 57.993132156754704; ...
133.7867875016015, 57.828785650138975; ...
133.88082499799722, 57.661486299838394; ...
133.975635020614, 57.49130283288787; ...
134.07098144474253, 57.3182978489238; ...
134.16664956906686, 57.14252887374768; ...
134.26244421327115, 56.96404871479555; ...
134.35818796857183, 56.782905867260325; ...
134.45371951811748, 56.5991449344558; ...
134.54889232305297, 56.412806895242994; ...
134.6435732604542, 56.22392943936176; ...
134.7376415195412, 56.03254719797278; ...
134.83098762289353, 55.8386919363795; ...
134.9235124603192, 55.64239267561061; ...
135.0151263238525, 55.443676322789; ...
135.1057484202218, 55.242567094086276; ...
135.19530598603453, 55.039087144496385; ...
135.28373376530644, 54.833256530822915; ...
135.37097334458528, 54.62509337774245; ...
135.4569727524433, 54.414613896922546; ...
135.54168588741297, 54.20183253273734; ...
135.6250721358517, 53.9867620034809; ...
135.70709601368324, 53.76941333947004; ...
135.78772671205354, 53.549796001239834; ...
135.86693793616104, 53.32791769814761; ...
135.9447072853078, 53.10378509805224; ...
136.02101633981187, 52.87740293814538; ...
136.0958502365486, 52.648774615002964; ...
136.1691974037035, 52.41790212096461; ...
136.24104938100987, 52.184786037796734; ...
136.31140067352518, 51.949425511536724; ...
136.3802484637878, 51.71181834203311; ...
136.44759256228318, 51.47196089882129; ...
136.51343515183603, 51.229848201141294; ...
136.5777806874775, 50.985473884748096; ...
136.6406358564102, 50.73882999067937; ...
136.7020091877303, 50.489907702912994; ...
136.7619113131004, 50.23869624756335; ...
136.82035459752163, 49.98518361896444; ...
136.87735313264258, 49.72935636120547; ...
136.93292270376668, 49.47119950089783; ...
136.98708060881643, 49.21069661175901; ...
137.03984570987618, 48.94782967911232; ...
137.09123827415644, 48.682579151832854; ...
137.14127996249888, 48.41492386612428; ...
137.18999382740844, 48.14484095922904; ...
137.23740417397218, 47.8723059122785; ...
137.28353666773413, 47.59729220650363; ...
137.3284180866013, 47.31977209550799; ...
137.37207652899548, 47.03971539236156; ...
137.41454131047573, 46.75709009676043; ...
137.45584290333792, 46.471862215152804; ...
137.49601297354474, 46.18399563651576; ...
137.53508442168965, 45.893451999310585; ...
137.5730912925984, 45.60019069348231; ...
137.6100689004055, 45.30416863596884; ...
137.64605374788925, 45.00534025907054; ...
137.68108359094037, 44.70365734345048; ...
137.71519753906423, 44.39906862428739; ...
137.74843589862522, 44.09152057625567; ...
137.7808404679719, 43.78095590148904; ...
137.8124544056038, 43.46731427315867; ...
137.84332234694676, 43.15053190503799; ...
137.87349052168932, 42.830541287031; ...
137.90300672857873, 42.50727108058507; ...
137.93192053981812, 42.18064573436314; ...
137.96028330244317, 41.850585331362616; ...
137.98814828568663, 41.517005251013224; ...
138.0155708559381, 41.17981578181295; ...
138.0426085415686, 40.8389216502957; ...
138.06932116425043, 40.494222487326866; ...
138.09577115215228, 40.14561098332141; ...
138.12202357368704, 39.79297343715618; ...
138.14814647758664, 39.436188862499236; ...
138.17421103217916, 39.075128537886755; ...
138.2002918411802, 38.709655297576354; ...
138.22646728185714, 38.33962275744957; ...
138.25281975200605, 37.964874634868615; ...
138.27943615141996, 37.58524370453206; ...
138.3064082202113, 37.200550911821026; ...
138.3338330821791, 36.81060391169356; ...
138.3618137541741, 36.415196776506285; ...
138.39045978766805, 36.014107101115634; ...
138.4198880142086, 35.60709522282163; ...
138.45022327756183, 35.1939022110516; ...
138.48159940600567, 34.77424763495905; ...
138.5141603346975, 34.34782698695799; ...
138.5480612426449, 33.91430895662594; ...
138.58347012377294, 33.473331877418026; ...
138.62056937435705, 33.02449996791685; ...
138.65955783122135, 32.567378648617655; ...
138.70065316752732, 32.10148902738813; ...
138.7440946478713, 31.626301230455777; ...
138.7901464088713, 31.141227867332276; ...
138.83910175059486, 30.645612665101996; ...
138.89128785237855, 30.138720546286596; ...
138.9470720161751, 29.61972310205462; ...
139.00686909649122, 29.08768145967987; ...
139.07115101565358, 28.54152447844535; ...
139.14045883322407, 27.98002110823555; ...
139.21541810332704, 27.401745171840986; ...
139.2967592213391, 26.805028892004213; ...
139.38534415312546, 26.187901763664946; ...
139.48220293215908, 25.54800699877215; ...
139.58858382647577, 24.882488297369367; ...
139.7060251731021, 24.187824513778626; ...
139.83646009718137, 23.45959260413449; ...
139.98237552696114, 22.692105940997646; ...
140.1470645109636, 21.877841587867476; ...
140.33504849438177, 21.006482838705622; ...
140.55283437328768, 20.06320455957857; ...
140.81040304927384, 19.02530571049111; ...
141.1245374125807, 17.854689424967717; ...
141.52788208133737, 16.47741646259607; ...
142.10417129792367, 14.704305492852294; ...
143.52758424809699, 11.01778437878172 ];

xlim([-180, 180]);
ylim([-90, 90]);

plot(curve1(:, 1), curve1(:, 2), 'b.')
plot(curve2(:, 1), curve2(:, 2), 'b.')


[XX, YY] = meshgrid(25:0.25:179, -37:0.25:69);
[C1, h1] = contour(XX, YY, data_der1, [0 0], 'r');
[C2, h2] = contour(XX, YY, data_der2, [0 0], 'r');
[C3, h3] = contour(XX, YY, data_der3, [0 0], 'r');
[C4, h4] = contour(XX, YY, data_der4, [0 0], 'r');
[C5, h5] = contour(XX, YY, data_der5, [0 0], 'r');
[C6, h6] = contour(XX, YY, data_der6, [0 0], 'r');
[C7, h7] = contour(XX, YY, data_der7, [0 0], 'r');
[C8, h8] = contour(XX, YY, data_der8, [0 0], 'r');

ht2 = clabel(C2, 0.0);
ht3 = clabel(C3, 0.0);
ht4 = clabel(C4, 0.0);
ht5 = clabel(C5, 0.0);
ht6 = clabel(C6, 0.0);
ht7 = clabel(C7, 0.0);
ht8 = clabel(C8, 0.0);
ht2(2).String = "3:30 UT";
ht3(2).String = "4:00 UT";
ht4(2).String = "4:30 UT";
ht5(2).String = "5:00 UT";
ht6(2).String = "5:30 UT";
ht7(2).String = "6:00 UT";
ht8(2).String = "6:30 UT";

contour(XX, YY, data, [0.001, 0.2, 0.4, 0.6, 0.8], 'LineWidth', 2);
contourf(XX, YY, data_umbra, [1, 1], 'LineStyle', 'none');
plot(path(:, 2), path(:, 1), 'b', 'LineWidth', 2);


num_lines = size(contour_mag0);
for ind_line = 1:num_lines
    plot([contour_mag0(ind_line, 2), contour_mag0(ind_line, 4)], [contour_mag0(ind_line, 1), contour_mag0(ind_line, 3)], 'k');
end